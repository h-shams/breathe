(()=>{"use strict";const e={anxiety:{name:"Anxiety",times:{in:4,hold:7,out:8},count:4},anger:{name:"Anger",times:{in:2,hold:3.5,out:4},count:5},irritation:{name:"irritation",times:{in:2,hold:3.5,out:4},count:5},scaring:{name:"Scaring",times:{in:2,hold:3.5,out:4},count:5},saddnes:{name:"Saddnes",times:{in:2,hold:3.5,out:4},count:5}},t=document.querySelector(".spinner"),o=document.querySelectorAll(".spinner__spot"),n=document.querySelector(".spinner__content-inner"),r=document.querySelector(".spinner__content-text--old"),s=document.querySelector(".spinner__content-text--new"),i=document.querySelector(".timer"),a=document.querySelector(".spinner-button-wrapper"),c=document.querySelector(".states-section");let l,u,d,p,m=null,y=null;function g(e){r.innerHTML!==e&&(s.innerHTML=e,n.classList.add("spinner__content-inner--text-change"),setTimeout((()=>{r.innerHTML=e,n.classList.remove("spinner__content-inner--text-change")}),250))}function v(e){let t=Math.floor(e/60);t<10&&(t="0"+t);let o=Math.floor(e)%60;o<10&&(o="0"+o);const n=`PT${t}M${o}S`;i.setAttribute("datetime",n),i.innerHTML=`${t}:${o}`}let f=!1,L=null;function h(){cancelAnimationFrame(L),t.style.setProperty("--grow-time","1.5s"),t.classList.remove("spinner--spin"),t.classList.add("spinner--ready"),f=!1,b(),g("start"),_("close"),S("visible")}function b(){t.classList.remove("spinner--grow")}function _(e){switch(e){case"open":a.classList.add("spinner-button-wrapper--expand");break;case"close":a.classList.remove("spinner-button-wrapper--expand")}}function S(e){switch(e){case"hidden":c.classList.add("states-section--hidden");break;case"visible":c.classList.remove("states-section--hidden")}}const q=document.querySelector(".overlay");function P(e){!function(e){const t=e.querySelector(".modal__button"),o=e.querySelector(".modal__body");t.removeEventListener("click",P),o.removeEventListener("scroll",w),e.classList.remove("modal--open"),q.classList.remove("overlay--open")}(e.target.parentElement.parentElement)}function w(e){const t=e.target;E(t.parentElement,t)}function E(e,t){const o=t.scrollHeight-t.clientHeight,n=t.scrollTop,r=o<50?o/2:50,s=e.style;0!==o&&(n<r?(s.setProperty("--top-opacity",n/r),"1"!==s.getPropertyValue("--bottom-opacity")&&s.setProperty("--bottom-opacity",1)):n>o-r?(s.setProperty("--bottom-opacity",(-n+o)/r),"1"!==s.getPropertyValue("--top-opacity")&&s.setProperty("--top-opacity",1)):("1"!==s.getPropertyValue("--bottom-opacity")&&s.setProperty("--bottom-opacity",1),"1"!==s.getPropertyValue("--top-opacity")&&s.setProperty("--top-opacity",1)))}"serviceWorker"in navigator?navigator.serviceWorker.register("./sw.bundle.js").then((e=>{console.log("service worker successfully registred")})).catch((e=>{console.log("error while regitering service worker"),console.log(e)})):console.log("service worker is not available");const k=[...document.querySelectorAll(".state")];k.forEach((e=>{e.addEventListener("click",T)}));let M=null;function T(n){const r=n.target.dataset.value;M=r,n.target.classList.add("state--active"),k.forEach((e=>{e.dataset.value!==r&&e.classList.remove("state--active")})),function(t){if(!e[t])return m=null,g("choose a state"),null;m!==t&&(h(),m=t,y=e[t],l=y.times.in,u=y.times.hold,d=y.times.out,p=l+u+d)}(M),function(){const e=[0,l/p*360,(l+u)/p*360],n=[0,Number.parseFloat(t.style.getPropertyValue("--spot1-angle")),Number.parseFloat(t.style.getPropertyValue("--spot2-angle"))];o.forEach(((t,o)=>{const n=`rotate(${e[o]}deg)`;let r;if(t.style.transform){const e=/rotate\(-?\d{1,3}(\.\d+)?deg\)/;r=t.style.transform.replace(e,n)}else r=getComputedStyle(t).transform+n;t.style.transform=r})),n.every(((t,o)=>t===e[o]))||function(e){t.classList.add("spinner--border-animation"),setTimeout((()=>{t.style.setProperty("--spot1-angle",e[1]+"deg"),t.style.setProperty("--spot2-angle",e[2]+"deg"),setTimeout((()=>{t.classList.remove("spinner--border-animation")}),500)}),500)}(e),t.style.setProperty("--rotate-time",p+"s"),t.style.setProperty("--grow-time",.93*Math.min(l,d)+"s"),g("start"),v(p*y.count),t.classList.add("spinner--ready")}()}document.querySelector(".spinner__content-inner").addEventListener("click",(()=>{!function(){if(!y)return;if(f)return;let e,o,n=1;f=!0,t.classList.add("spinner--spin"),t.classList.remove("spinner--ready"),_("open"),S("hidden"),requestAnimationFrame((function r(s){void 0===e&&(e=s),void 0===o&&(o=s);const i=(s-e)/1e3,a=Math.floor((s-o)/1e3);v(Math.floor(p*y.count-a)),i>0&&i<l?(t.style.setProperty("--grow-time",.93*l+"s"),g("breathe in"),t.classList.add("spinner--grow")):l<i&&i<l+u?g("hold"):(t.style.setProperty("--grow-time",.93*d+"s"),g("breathe out"),b()),i>=p&&(e=s,n++),n>y.count&&h(),f&&(L=requestAnimationFrame(r))}))}()})),document.querySelector(".spinner-button").addEventListener("click",(()=>{h()}));const x=document.querySelector("#about-modal");document.querySelector(".header__about-button").addEventListener("click",(()=>{!function(e){const t=e.querySelector(".modal__button"),o=e.querySelector(".modal__overlay"),n=e.querySelector(".modal__body");t.addEventListener("click",P),n.addEventListener("scroll",w),E(o,n),e.classList.add("modal--open"),q.classList.add("overlay--open")}(x)}))})();